{"version":3,"file":"search-bar.cjs","sources":["../../src/layout/search-bar.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { SearchIcon, STLArrowIcon } from \"@/icons\"\n\nexport interface SearchHistoryItem {\n  id: string\n  text: string\n}\n\nexport interface SearchBarProps {\n  /** 플레이스홀더 텍스트 */\n  placeholder?: string\n  /** 검색어 */\n  value?: string\n  /** 검색어 변경 핸들러 */\n  onChange?: (value: string) => void\n  /** 검색 실행 핸들러 (Enter 키) */\n  onSearch?: (value: string) => void\n  /** 최근 검색어 목록 */\n  recentSearches?: SearchHistoryItem[]\n  /** 최근 검색어 클릭 핸들러 */\n  onRecentSearchClick?: (item: SearchHistoryItem) => void\n  /** 추가 className */\n  className?: string\n  /** 비활성화 */\n  disabled?: boolean\n}\n\nconst SearchBar = React.forwardRef<HTMLInputElement, SearchBarProps>(\n  (\n    {\n      placeholder = \"검색어를 입력하세요\",\n      value,\n      onChange,\n      onSearch,\n      recentSearches = [],\n      onRecentSearchClick,\n      className,\n      disabled,\n    },\n    ref\n  ) => {\n    const [open, setOpen] = React.useState(false)\n    const [internalValue, setInternalValue] = React.useState(\"\")\n    const [highlightedIndex, setHighlightedIndex] = React.useState(-1)\n    const containerRef = React.useRef<HTMLDivElement>(null)\n\n    const searchValue = value !== undefined ? value : internalValue\n\n    const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n      const newValue = e.target.value\n      if (value === undefined) {\n        setInternalValue(newValue)\n      }\n      onChange?.(newValue)\n      setHighlightedIndex(-1)\n    }\n\n    const handleKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\n      const itemCount = recentSearches.length\n\n      if (e.key === \"ArrowDown\") {\n        e.preventDefault()\n        if (!open && itemCount > 0) {\n          setOpen(true)\n          setHighlightedIndex(0)\n        } else if (open && itemCount > 0) {\n          setHighlightedIndex((prev) => (prev + 1) % itemCount)\n        }\n      }\n\n      if (e.key === \"ArrowUp\") {\n        e.preventDefault()\n        if (open && itemCount > 0) {\n          setHighlightedIndex((prev) => (prev - 1 + itemCount) % itemCount)\n        }\n      }\n\n      if (e.key === \"Enter\") {\n        if (open && highlightedIndex >= 0 && recentSearches[highlightedIndex]) {\n          handleRecentClick(recentSearches[highlightedIndex])\n        } else {\n          onSearch?.(searchValue)\n          setOpen(false)\n        }\n      }\n\n      if (e.key === \"Escape\") {\n        setOpen(false)\n        setHighlightedIndex(-1)\n      }\n    }\n\n    const handleRecentClick = (item: SearchHistoryItem) => {\n      if (value === undefined) {\n        setInternalValue(item.text)\n      }\n      onChange?.(item.text)\n      onRecentSearchClick?.(item)\n      setOpen(false)\n      setHighlightedIndex(-1)\n    }\n\n    // 외부 클릭 감지\n    React.useEffect(() => {\n      const handleClickOutside = (e: MouseEvent) => {\n        if (containerRef.current && !containerRef.current.contains(e.target as Node)) {\n          setOpen(false)\n          setHighlightedIndex(-1)\n        }\n      }\n\n      if (open) {\n        document.addEventListener(\"mousedown\", handleClickOutside)\n      }\n\n      return () => {\n        document.removeEventListener(\"mousedown\", handleClickOutside)\n      }\n    }, [open])\n\n    const showDropdown = open && recentSearches.length > 0\n\n    return (\n      <div ref={containerRef} className=\"relative\">\n        <div\n          className={cn(\n            \"relative flex h-9 items-center gap-2 rounded-[20px] border\",\n            \"bg-white dark:bg-slate-800\",\n            \"border-slate-100 dark:border-slate-600\",\n            \"px-3 cursor-text\",\n            \"focus-within:border-slate-500 dark:focus-within:border-slate-100\",\n            \"transition-colors\",\n            disabled && \"opacity-50 cursor-not-allowed\",\n            className\n          )}\n        >\n          <SearchIcon size={20} className=\"text-slate-500 dark:text-slate-50 shrink-0\" />\n          <input\n            ref={ref}\n            type=\"text\"\n            value={searchValue}\n            onChange={handleChange}\n            onKeyDown={handleKeyDown}\n            onFocus={() => !disabled && setOpen(true)}\n            placeholder={placeholder}\n            disabled={disabled}\n            className={cn(\n              \"flex-1 bg-transparent text-xs outline-none\",\n              \"text-slate-900 dark:text-slate-50\",\n              \"placeholder:text-slate-300 dark:placeholder:text-slate-50\",\n              \"disabled:cursor-not-allowed\"\n            )}\n          />\n          <STLArrowIcon size={24} className=\"text-blue-500 dark:text-slate-50 shrink-0\" />\n        </div>\n\n        {showDropdown && (\n          <div\n            className={cn(\n              \"absolute left-0 right-0 top-full mt-[13px] z-[100]\",\n              \"overflow-hidden rounded-[5px] border\",\n              \"border-slate-100 dark:border-slate-600\",\n              \"bg-white/90 dark:bg-slate-800/90 backdrop-blur-[12px]\",\n              \"shadow-[10px_10px_10px_0px_rgba(0,0,0,0.05)]\",\n              \"p-[5px]\",\n              \"animate-in fade-in-0 zoom-in-95 slide-in-from-top-2\"\n            )}\n          >\n            {recentSearches.map((item, index) => (\n              <button\n                key={item.id}\n                type=\"button\"\n                onClick={() => handleRecentClick(item)}\n                onMouseEnter={() => setHighlightedIndex(index)}\n                className={cn(\n                  \"flex h-[29px] w-full cursor-pointer select-none items-center rounded-[2px] px-[5px] py-[5px]\",\n                  \"text-xs text-slate-500 dark:text-slate-300 text-left\",\n                  \"hover:bg-slate-100 dark:hover:bg-slate-700\",\n                  \"focus:bg-slate-100 dark:focus:bg-slate-700 outline-none\",\n                  \"transition-colors\",\n                  highlightedIndex === index && \"bg-slate-100 dark:bg-slate-700\"\n                )}\n              >\n                {item.text}\n              </button>\n            ))}\n          </div>\n        )}\n      </div>\n    )\n  }\n)\nSearchBar.displayName = \"SearchBar\"\n\nexport { SearchBar }\n"],"names":["SearchBar","React","placeholder","value","onChange","onSearch","recentSearches","onRecentSearchClick","className","disabled","ref","open","setOpen","internalValue","setInternalValue","highlightedIndex","setHighlightedIndex","containerRef","searchValue","handleChange","newValue","handleKeyDown","itemCount","prev","handleRecentClick","item","handleClickOutside","e","showDropdown","jsxs","cn","jsx","SearchIcon","STLArrowIcon","index"],"mappings":"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"}